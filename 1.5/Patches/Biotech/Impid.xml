<Patch>
	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>friedrice</modId>
		<key>reworkImpid</key>
		<defaultValue>true</defaultValue>
		<caseTrue>
			<!--Replace Impid genepool-->
			<Operation Class="PatchOperationReplace">
				<xpath>Defs/XenotypeDef[defName="Impid"]/genes</xpath>
				<value>
					<genes>
						<li>PsychicAbility_Deaf</li>
						<li>Mood_Pessimist</li>
						<li>MaxTemp_LargeIncrease</li>
						<li>FireResistant</li>
						<li>Pain_Reduced</li>
						<li>Beard_NoBeardOnly</li>
						<li>Headbone_MiniHorns</li>
						<li>Body_Standard</li>
						<li>Body_Thin</li>
						<li>Hair_SandyBlonde</li>
						<li>Hair_LightOrange</li>
						<li>Skin_Orange</li>
						<li>Skin_DeepRed</li>
					</genes>
				</value>
			</Operation>
			<!--Lower Impid combat power to reflect changes-->
			<Operation Class="PatchOperationReplace">
				<xpath>Defs/XenotypeDef[defName="Impid"]/combatPowerFactor</xpath>
				<value>
					<combatPowerFactor>1</combatPowerFactor>
				</value>
			</Operation>
			<!--Add greater Impids-->
			<Operation Class="PatchOperationAdd">
				<xpath>Defs</xpath>
				<value>
					<XenotypeDef>
						<defName>GreaterImpid</defName>
						<label>greater impid</label>
						<description>Made for desert life, impid cultures live on many rimworlds and dry deathworlds. Impids are extremely fast-moving, easily tolerate high temperatures, and can spew fire from their mouths. Though they are masters on the sand, impids struggle in other environments. They are terrible with farming. They fight well at range, but in close combat their physical weakness becomes apparent.\n\nOutlanders call them dustrunners because of their speed over open terrain and resistance to heat. Some tribes call them devils because of their horns and because they burn their enemies. Impid tribes' combat tactics usually center on rapid-approach incendiary attacks using both handheld fire weapons and their fire spew ability.</description>
						<descriptionShort>Made for desert life, impids are very fast, can spew fire from their mouths, and easily tolerate high temperatures. They fight well at range, but in close combat they do little damage. They are terrible with farming, and have weak immune systems.</descriptionShort>
						<iconPath>UI/Icons/Xenotypes/Impid</iconPath>
						<inheritable>true</inheritable>
						<combatPowerFactor>1.5</combatPowerFactor>
						<nameMaker>NamerPersonImpid</nameMaker>
						<chanceToUseNameMaker>1</chanceToUseNameMaker>
						<factionlessGenerationWeight>0</factionlessGenerationWeight>
						<genes>
							<li>FireSpew</li>
							<li>PsychicAbility_Deaf</li>
							<li>Mood_Pessimist</li>
							<li>MaxTemp_LargeIncrease</li>
							<li>FireResistant</li>
							<li>KillThirst</li>
							<li>Robust</li>
							<li>Pain_Reduced</li>
							<li>Beard_NoBeardOnly</li>
							<li>Headbone_MiniHorns</li>
							<li>FacialRidges</li>
							<li>Body_Standard</li>
							<li>Body_Thin</li>
							<li>Hair_SandyBlonde</li>
							<li>Hair_LightOrange</li>
							<li>Skin_Orange</li>
							<li>Skin_DeepRed</li>
						</genes>
					</XenotypeDef>
				</value>
			</Operation>
			<Operation Class="PatchOperationAdd">
				<xpath>Defs/XenotypeDef[defName="Impid"]</xpath>
				<value>
					<doubleXenotypeChances>
						<GreaterImpid>0.02</GreaterImpid>
					</doubleXenotypeChances>
				</value>
			</Operation>
			<!--Reduce commonality of Impid settlements-->
			<Operation Class="PatchOperationAdd">
				<xpath>Defs/FactionDef[defName="TribeSavageImpid"]</xpath>
				<value>
					<settlementGenerationWeight Inherit="False">0.8</settlementGenerationWeight>
				</value>
			</Operation>
			<!--Remove Impids from Waster faction-->
			<Operation Class="PatchOperationRemove">
				<xpath>Defs/FactionDef[defName="PirateWaster"]/xenotypeSet/xenotypeChances/Impid</xpath>
			</Operation>
			<!--Remove Impid earliest raid date since they're not OP anymore-->
			<Operation Class="PatchOperationRemove">
				<xpath>Defs/FactionDef[defName="TribeSavageImpid"]/earliestRaidDays</xpath>
			</Operation>
			<Operation Class="PatchOperationFindMod">
				<mods>
					<li>Vanilla Expanded Framework</li>
				</mods>
				<match Class="PatchOperationSequence">
					<operations>
						<!--limits impids to desert biomes-->
						<li Class="PatchOperationAdd">
							<xpath>Defs/FactionDef[defName="TribeSavageImpid"]</xpath>
							<value>
								<modExtensions>
									<li Class="VFECore.FactionDefExtension">
										<allowedBiomes>
											<li>AridShrubland</li>
											<li>Desert</li>
											<li>ExtremeDesert</li>
										</allowedBiomes>
									</li>
								</modExtensions>
							</value>
						</li>
					</operations>
				</match>
				<nomatch Class="PatchOperationSequence">
					<operations>
						<!--Limits Impids to the equator-->
						<li Class="PatchOperationAdd">
							<xpath>Defs/FactionDef[defName="TribeSavageImpid"]</xpath>
							<value>
								<minSettlementTemperatureChanceCurve>
									<points>
										<li>(0, 0.00001)</li>
										<li>(6, 0.7)</li>
										<li>(12,0.9)</li>
										<li>(18,0.95)</li>
										<li>(24,1)</li>
									</points>
								</minSettlementTemperatureChanceCurve>
							</value>
						</li>
					</operations>
				</nomatch>
			</Operation>
		</caseTrue>
	</Operation>
</Patch>